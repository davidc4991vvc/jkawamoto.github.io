<!DOCTYPE html> <html> <head prefix="og: http://ogp.me/ns#"> <meta charset="utf-8"> <meta http-equiv="content-language" content="ja"> <title>Compiling a Sphinx document on Wercker &middot; Junpei Kawamoto</title> <base href="https://www.jkawamoto.info/"> <meta name="generator" content="Hugo 0.18-DEV"> <meta name="viewport" content="width=device-width,initial-scale=1"> <meta name="author" content="Junpei Kawamoto"> <meta name="description" content="This entry describes how to compile your Sphinx document on Wercker, a cloud CI service."> <meta name="”keywords”" content="”sphinx,wercker”"> <meta property="og:type" content="article"> <meta property="og:title" content="Compiling a Sphinx document on Wercker &middot; Junpei Kawamoto"> <meta name="og:description" content="This entry describes how to compile your Sphinx document on Wercker, a cloud CI service."> <meta property="og:image" content="https://www.jkawamoto.info/images/wordcloud.png"> <meta property="og:site_name" content="Junpei Kawamoto"> <meta name="twitter:card" content="This entry describes how to compile your Sphinx document on Wercker, a cloud CI service."> <meta name="twitter:site" content="@junkawamoto"> <link rel="stylesheet" href="/css/main.css"> <link rel="preload" as="style" href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" onload='this.rel="stylesheet"'> <link rel="preload" as="style" href="/css/custom.css" onload='this.rel="stylesheet"'> <noscript> <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css"> <link rel="stylesheet" href="/css/custom.css"> </noscript> <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-4734862314145555",enable_page_level_ads:!0})</script> </head> <body id="top"> <div class="remodal-bg"> <header id="header"> <a href="#" class="image avatar"><img src="/images/avatar.jpg" alt=""></a> <h1 style="text-shadow:1px 1px 5px #000;color:rgba(255,255,255,.7)"><strong>Junpei Kawamoto</strong>, Ph.D. in Informatics.<br>Research scientist working with data mining, security, and privacy.</h1> <br> <ul style="list-style:none;text-shadow:1px 1px 5px #000;margin:0"> <li style="display:inline-block"><a href="/#main">Home</a></li> <li style="display:inline-block"><a href="/blogs/#main">Blog</a></li> <li style="display:inline-block"><a href="/publications/#main">Publications</a></li> <li style="display:inline-block"><a href="/research/#main">Research</a></li> <li style="display:inline-block"><a href="/lectures/#main">Lectures</a></li> </ul> <ul style="list-style:none;text-shadow:1px 1px 5px #000"> <li style="display:inline-block"><a href="/japanese/#main">日本語</a></li> <li style="display:inline-block"><a href="/publications-ja/#main">論文リスト</a></li> <li style="display:inline-block"><a href="/blog-ja/#main">メモ</a></li> <li style="display:inline-block"><a href="/activity-ja/#main">その他の活動</a></li> </ul> </header> <div id="main"> <h1>Compiling a Sphinx document on Wercker</h1> <p> <span> <i class="fa fa-calendar" aria-hidden="true"></i> Posted: <time pubdate="2016-08-18">2016-08-18</time>, Modified: <time pubdate="2016-08-18">2016-08-18</time> </span> &nbsp; <spna> <i class="fa fa-tags" aria-hidden="true"></i> sphinx wercker  <br> <span> <i class="fa fa-certificate" aria-hidden="true"></i> <a href="https://blockai.com/c/b66M3Q">Copyright certificate by blockai</a> </span> </spna></p> <div class="addthis_inline_share_toolbox"></div> <div style="padding:5px"> <p> <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4734862314145555" data-ad-slot="7714563027" data-ad-format="auto"></ins> <script>(adsbygoogle=window.adsbygoogle||[]).push({})</script> </p> </div> <p>After import your repository, application page looks like this. Move on the workflow tab.</p> <p><a href="/fig/2016-08-18-1.png"><img src="/fig/2016-08-18-1.png" alt="Fig. 1"></a></p> <p>Open configuration of the <code>build</code> pipeline.</p> <p><a href="/fig/2016-08-18-2.png"><img src="/fig/2016-08-18-2.png" alt="Fig. 2"></a></p> <p>In the configuration of the build pipeline, scroll down to Permission level.</p> <p><a href="/fig/2016-08-18-3.png"><img src="/fig/2016-08-18-3.png" alt="Fig. 3"></a></p> <p>And choose <code>execute pipeline</code> in order to prevent someone starting pipeline and see detailed logs. Also set <code>gh-pages</code> to Ignore branches so that Wercker will not start building documents after pushing to <code>gh-pages</code> branch.</p> <p><a href="/fig/2016-08-18-4.png"><img src="/fig/2016-08-18-4.png" alt="Fig. 4"></a></p> <p>Then, back to the workflow tab and add a new pipeline.</p> <p><a href="/fig/2016-08-18-5.png"><img src="/fig/2016-08-18-5.png" alt="Fig. 5"></a></p> <p>Now, we name the new pipeline <code>deploy</code>, and hook type should be default to be chained to the build pipeline.</p> <p><a href="/fig/2016-08-18-6.png"><img src="/fig/2016-08-18-6.png" alt="Fig. 6"></a></p> <p>In order to push built documents to GitHub, this pipeline should know an access token of GitHub. Add such key with name <code>GIT_TOKEN</code> and protected option in the environment variables section of <code>deploy</code> pipeline.</p> <p><a href="/fig/2016-08-18-7.png"><img src="/fig/2016-08-18-7.png" alt="Fig. 7"></a></p> <p>The token can be obtained in <a href="https://github.com/settings/tokens">https://github.com/settings/tokens</a>. If your repository is public, you only need a token with <code>public_repo</code> scope. Otherwise, you may need a token with <code>repo</code> scope.</p> <p><a href="/fig/2016-08-18-8.png"><img src="/fig/2016-08-18-8.png" alt="Fig. 8"></a></p> <p>After adding <code>GIT_TOKEN</code>, check Permission level is Execute pipelines.</p> <p><a href="/fig/2016-08-18-9.png"><img src="/fig/2016-08-18-9.png" alt="Fig. 9"></a></p> <p>Next, make a workflow connecting the <code>deploy</code> pipeline to the <code>build</code> one in Workflow tab. Make sure this workflow only runs on master branch.</p> <p><a href="/fig/2016-08-18-10.png"><img src="/fig/2016-08-18-10.png" alt="Fig. 10"></a></p> <p>In the end, the workflow looks like the followings.</p> <p><a href="/fig/2016-08-18-11.png"><img src="/fig/2016-08-18-11.png" alt="Fig. 11"></a></p> <p>Next, you need to add <code>wercker.yml</code> in your branch root. You use Sphinx to build documents of which sources are in <code>docs</code>. <code>wercker.yml</code> may be there.</p> <pre><code class="language-js">box: jkawamoto/ghp-box
build:
  steps:
    - jkawamoto/sphinx:
        basedir: docs
        packages: sphinx_rtd_theme
deploy:
  steps:
    - jkawamoto/ghp-import:
        token: $GIT_TOKEN
        basedir: docs/build/html
</code></pre> <p>It also specifies to install <code>sphinx_rtd_theme</code>. Make sure after running <code>make html</code> in <code>doc</code> folder, your documents are in <code>docs/build/html</code>. Otherwise, edit <code>basedir</code> in the last line.</p> <h2 id="references">References</h2> <ul> <li><a href="https://github.com/jkawamoto/dockerfiles/tree/master/wercker-ghp-box">jkawamoto/ghp-box</a></li> <li><a href="https://github.com/jkawamoto/wercker-sphinx-step">jkawamoto/sphinx</a></li> <li><a href="https://github.com/jkawamoto/wercker-ghp-import-step">jkawamoto/ghp-import</a></li> </ul> <div class="addthis_relatedposts_inline"></div> <p> <ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-4734862314145555" data-ad-slot="3140329829"></ins> <script>(adsbygoogle=window.adsbygoogle||[]).push({})</script> <ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-4734862314145555" data-ad-slot="3140329829"></ins> <script>(adsbygoogle=window.adsbygoogle||[]).push({})</script> </p> <div id="disqus_thread"></div> <script>!function(){var e=document,t=e.createElement("script");t.src="//my-site-3.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)}()</script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> </div> <footer id="footer"> <ul class="icons"> <li><a href="//facebook.com/junpei.kawamoto" target="_blank" class="icon fa-facebook"><span class="label">Facebook</span></a></li> <li><a href="//twitter.com/junkawamoto" target="_blank" class="icon fa-twitter"><span class="label">Twitter</span></a></li> <li><a href="//github.com/jkawamoto" target="_blank" class="icon fa-github"><span class="label">Github</span></a></li> <li><a href="///www.linkedin.com/in/jkawamoto" target="_blank" class="icon fa-linkedin"><span class="label">LinkedIn</span></a></li> <li><a href="//www.youtube.com/channel/UCAImvZQSpr4dw6USxHNqDXg" target="_blank" class="icon fa-youtube"><span class="label">Youtube</span></a></li> <li><a href="//flickr.com/photos/junkawamoto" target="_blank" class="icon fa-flickr"><span class="label">Flickr</span></a></li> <li><a href="mailto:junpei.kawamoto@acm.org" class="icon fa-envelope-o"><span class="label">Email</span></a></li> <li><a href="#" data-remodal-target="wallet" class="icon fa-btc"><span class="label">BTC</span></a></li> </ul> <ul class="copyright"> <li>&copy; Junpei Kawamoto</li> <li>Design: <a href="//html5up.net">HTML5 UP</a></li> <li><a href="https://www.littlekitune.org/">Little Kitune studio</a></li> </ul> </footer> <aside> <script src="/js/jquery.min.js"></script> <script src="/js/jquery.poptrox.min.js"></script> <script src="/js/skel.min.js"></script> <script src="/js/util.js"></script> <script src="/js/main.js"></script> <script>var _gaq=[["_setAccount","UA-19410992-1"],["_trackPageview"]];!function(e,t){var a=e.createElement(t),o=e.getElementsByTagName(t)[0];a.src=("https:"==location.protocol?"//ssl":"//www")+".google-analytics.com/ga.js",o.parentNode.insertBefore(a,o)}(document,"script")</script> <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/styles/agate.min.css"> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script> <script>hljs.initHighlightingOnLoad()</script> <script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-57f285f012d45509"></script> </aside> </div> <div class="remodal" data-remodal-id="wallet"> <button data-remodal-action="close" class="remodal-close"></button> <h1>Bitcoin wallet</h1> <p> My wallet address: <span>1625kBbXoGRWRh92XcgLFik5E6PgV482sm</span> <br> <img src="https://chart.googleapis.com/chart?chs=250x250&cht=qr&chl=bitcoin:1625kBbXoGRWRh92XcgLFik5E6PgV482sm"> </p> <br> <button data-remodal-action="cancel" class="remodal-cancel">Close</button> </div> <link rel="stylesheet" href="css/remodal.css"> <link rel="stylesheet" href="css/remodal-default-theme.css"> <script src="js/remodal.min.js"></script> </body> </html> 